@namespace AntDesign.Pro.Layout
@inherits AntProComponentBase

<Menu
    Mode="Mode"
    DefaultOpenKeys="OpenKeys"
    Theme="Theme"
    Style="@Style"
    Class="@ClassMapper.Class"
    OnOpenChange="SetOpenKeys">
    @if (MenuData != null)
    {
        @foreach (var el in GetNavMenuItems(MenuData, false))
        {
            @el
        }
    }
</Menu>

@code
{
    IEnumerable<RenderFragment> GetNavMenuItems(MenuDataItem[] items, bool isChildren)
    {
        foreach (var item in items)
        {
            if (!item.HideInMenu)
            {
                yield return GetSubMenuOrItem(item, isChildren);
            }
        }
    }

    RenderFragment GetSubMenuOrItem(MenuDataItem item, bool isChildren)
    {
        RenderFragment title = @<span>
                                    @item.Icon
                                    <span>@item.Name</span>
                                </span>;
        if (item.Children != null && !item.HideChildrenInMenu)
        {
            return @<SubMenu
                        Title="@title"
                        Key="@item.Key">
                       @foreach (var el in GetNavMenuItems(@item.Children, true))
                       {
                           @el
                       }
                   </SubMenu>;
        }
        else
        {
            return @<MenuItem RouterLink="@item.Path">@title</MenuItem>;
        }
    }
}
